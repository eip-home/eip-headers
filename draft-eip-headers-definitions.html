<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Extensible In-band Processing (EIP) Headers Definitions</title>
<meta content="Stefano Salsano" name="author">
<meta content="Hesham ElBakoury" name="author">
<meta content="Giulio Sidoretti" name="author">
<meta content="Carmine Scarpitta" name="author">
<meta content="
       This document discusses the EIP header format. 
       Caveat: this document is still in brainstorming stage,
it is distributed to stimulate discussion. 
    " name="description">
<meta content="xml2rfc 3.23.0" name="generator">
<meta content="IPv6" name="keyword">
<meta content="Extension Headers" name="keyword">
<meta content="draft-eip-headers-definitions-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.23.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-eip-headers-definitions.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">EIP Headers</td>
<td class="right">September 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Salsano, et al.</td>
<td class="center">Expires 21 March 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">SIG on EIP</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-eip-headers-definitions-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-09-17" class="published">17 September 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-03-21">21 March 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Salsano</div>
<div class="org">Univ. of Rome Tor Vergata / CNIT</div>
</div>
<div class="author">
      <div class="author-name">H. ElBakoury</div>
<div class="org">Consultant</div>
</div>
<div class="author">
      <div class="author-name">G. Sidoretti</div>
<div class="org">Univ. of Rome Tor Vergata / CNIT</div>
</div>
<div class="author">
      <div class="author-name">C. Scarpitta</div>
<div class="org">Univ. of Rome Tor Vergata / CNIT</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Extensible In-band Processing (EIP) Headers Definitions</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document discusses the EIP header format.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">Caveat: this document is still in brainstorming stage,
it is distributed to stimulate discussion.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://eip-home.github.io/eip-headers/draft-eip-headers-definitions.html">https://eip-home.github.io/eip-headers/draft-eip-headers-definitions.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-eip-headers-definitions/">https://datatracker.ietf.org/doc/draft-eip-headers-definitions/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        EIP SIG mailing list (<span><a href="mailto:eip@cnit.it">mailto:eip@cnit.it</a></span>),
        which is archived at <span><a href="http://postino.cnit.it/cgi-bin/mailman/private/eip/">http://postino.cnit.it/cgi-bin/mailman/private/eip/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/eip-home/eip-headers">https://github.com/eip-home/eip-headers</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 21 March 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-definition-of-eip-option-fo" class="internal xref">Definition of EIP Option for HBH EH</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-definition-of-eip-tlv-for-s" class="internal xref">Definition of EIP TLV for SRH</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-generic-format-for-eip-info" class="internal xref">Generic format for EIP Information Elements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-proposed-approach-1-for-eip" class="internal xref">Proposed approach #1 for EIP LTVs.</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-proposed-approach-2-for-eip" class="internal xref">Proposed approach #2 for EIP LTVs.</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-decision-on-the-approach-fo" class="internal xref">Decision on the approach for EIP LTVs</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-definition-of-eip-informati" class="internal xref">Definition of EIP Information Elements (a.k.a. EIP LTVs)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-hmac-ltv" class="internal xref">HMAC LTV</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-eip-identifiers-ltvs" class="internal xref">EIP Identifiers LTVs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-eip-short-identifier-ltv" class="internal xref">EIP Short Identifier LTV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-eip-long-identifier-ltv" class="internal xref">EIP Long Identifier LTV</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-timestamps-ltv" class="internal xref">Timestamps LTV:</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-node-selection-and-identifi" class="internal xref">Node selection and identification LTV</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-processing-accelerator-ltv" class="internal xref">Processing Accelerator LTV</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="auto internal xref">5.6</a>.  <a href="#name-compact-path-tracing-cpt-lt" class="internal xref">Compact Path Tracing (CPT) LTV</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6.2.1">
                    <p id="section-toc.1-1.5.2.6.2.1.1"><a href="#section-5.6.1" class="auto internal xref">5.6.1</a>.  <a href="#name-authenticated-mode-for-comp" class="internal xref">Authenticated mode for Compact Path Tracing</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6.2.2">
                    <p id="section-toc.1-1.5.2.6.2.2.1"><a href="#section-5.6.2" class="auto internal xref">5.6.2</a>.  <a href="#name-geotagged-compact-path-trac" class="internal xref">Geotagged Compact Path Tracing</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="auto internal xref">5.7</a>.  <a href="#name-geotagging-ltv" class="internal xref">Geotagging LTV</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a href="#section-5.8" class="auto internal xref">5.8</a>.  <a href="#name-simple-two-way-active-measu" class="internal xref">Simple Two-Way Active Measurement Protocol (STAMP) LTV</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-code-assignment-for-eip-inf" class="internal xref">Code assignment for EIP Information Elements (a.k.a. EIP LTVs)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-ltv-short-codes" class="internal xref">LTV Short Codes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-ltv-extended-codes" class="internal xref">LTV Extended Codes</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The EIP header is used to carry information that IPv6 nodes (hosts and routers) can read and write to support different use cases. The use cases for EIP are discussed in <span>[<a href="#id-eip-use-cases" class="cite xref">id-eip-use-cases</a>]</span>.
EIP provides a common architecture and framework which can be extended/tailored for the different use cases. The EIP architecture is discussed in <span>[<a href="#id-eip-arch" class="cite xref">id-eip-arch</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The design of the EIP header takes into account the requirement to be
efficient and "hardware friendly" (i.e. the effort and cost to implement EIP
in hardware achieving line rate forwarding needs to be reasonable).<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The benefits of having EIP as a common header and framework to support
multiple use cases are discussed in <span>[<a href="#id-eip-arch" class="cite xref">id-eip-arch</a>]</span>.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The EIP header could be carried in different ways inside the IPv6 Header:
1) EIP Option for Hop-by-Hop Extension Header; 2) EIP TLV for Segment Routing Header<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">It has to be decided if only one of the two mechanisms will be selected or if it will be deemed useful to specify and support both mechanisms.<a href="#section-1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="definition-of-eip-option-for-hbh-eh">
<section id="section-2">
      <h2 id="name-definition-of-eip-option-fo">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-definition-of-eip-option-fo" class="section-name selfRef">Definition of EIP Option for HBH EH</a>
      </h2>
<p id="section-2-1">The EIP header can be carried as an Option in the Hop by Hop Extension Header, as shown in the following figure.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2-2">
<pre>
                                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                   | Option type   |Opt Data Len=xx|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   EIP Information Elements (variable in number and length)    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         ......                                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         ......                                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-2-2" class="pilcrow">¶</a>
</div>
<p id="section-2-3">Option type<a href="#section-2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2-4">
<pre>
   +-+-+-+-+-+-+-+-+
   |0|0|1|EIP code |
   +-+-+-+-+-+-+-+-+
</pre><a href="#section-2-4" class="pilcrow">¶</a>
</div>
<p id="section-2-5">First 3 bits in Option type field:<a href="#section-2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-6.1">
          <p id="section-2-6.1.1">0 0 Skip if not implemented<a href="#section-2-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-6.2">
          <p id="section-2-6.2.1">1 Content might change at every hop<a href="#section-2-6.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-7">(eventually) EIP code needs to be allocated by IANA
   for the time being we use 11110, so overall the Option Type for EIP is<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">0x3E (001 11110) RFC3692-style Experiment<a href="#section-2-8" class="pilcrow">¶</a></p>
<p id="section-2-9">Opt Data Len is the lenght in bytes of the rest of the EIP Option<a href="#section-2-9" class="pilcrow">¶</a></p>
<p id="section-2-10">Within the EIP Option, we have a LTV structure:<a href="#section-2-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2-11">
<pre>
  EIP-LTV a code that is specific of each EIP LTV
  LTV Len is the lenght in bytes of the rest of the LTV
</pre><a href="#section-2-11" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="definition-of-eip-tlv-for-srh">
<section id="section-3">
      <h2 id="name-definition-of-eip-tlv-for-s">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-definition-of-eip-tlv-for-s" class="section-name selfRef">Definition of EIP TLV for SRH</a>
      </h2>
<p id="section-3-1">The EIP header can be carried as a TLV in the Segment Routing Header. A generic TLV in the SRH is defined as follows.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-2">
<pre>
    0                   1
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-----------------------
   |     Type      |    Length     | Variable-length data
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-----------------------
</pre><a href="#section-3-2" class="pilcrow">¶</a>
</div>
<p id="section-3-3">First bit in type field:
   1 - Content might change at every hop<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">type code needs (eventually) to be allocated by IANA
   for the time being we use 252 for the EIP TLV.
   This is part of the experimental range<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">252-254  Experimentation and Test  <span>[<a href="#RFC8754" class="cite xref">RFC8754</a>]</span><a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">NB current IANA allocation for Types starting with 1 is
   (see https://www.iana.org/assignments/ipv6-parameters/ipv6-parameters.xhtml#segment-routing-header-tlvs)<a href="#section-3-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-7">
<pre>
   127 possible Option Types starting with 1
   123 not allocated
   3 allocated for Experimentation and Test
   1 Reserved
</pre><a href="#section-3-7" class="pilcrow">¶</a>
</div>
<p id="section-3-8">128-251  Unassigned<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">252-254  Experimentation and Test  <span>[<a href="#RFC8754" class="cite xref">RFC8754</a>]</span><a href="#section-3-9" class="pilcrow">¶</a></p>
<p id="section-3-10">255  Reserved  <span>[<a href="#RFC8754" class="cite xref">RFC8754</a>]</span><a href="#section-3-10" class="pilcrow">¶</a></p>
<p id="section-3-11">The EIP TLV for SRH will carry a set of EIP Information Elements as shown hereafter.<a href="#section-3-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-12">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                   |1|   EIP       |    Length     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   EIP Information Elements (variable in number and length)    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         ......                                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         ......                                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre><a href="#section-3-12" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="generic-format-for-eip-information-elements">
<section id="section-4">
      <h2 id="name-generic-format-for-eip-info">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-generic-format-for-eip-info" class="section-name selfRef">Generic format for EIP Information Elements</a>
      </h2>
<p id="section-4-1">EIP Information Elements are used to carry the information needed by the different use cases.
The same Information Element can be reused across multiple use cases.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">An fundamental requirement for EIP is to be "Extensible", therefore we need to have a potentially large number of different Information Elements. On the other hand, we may need to be efficient, limiting the overhead in bytes for carrying a given information. In order to have the possibility to find the optimal trade-off between these contrasting requirements, the Codes or "Tags" for the Information Elements can have different sizes. In particular, we select a solution in which the Codes can have three different lengths (respectively one byte, two bytes or three bytes).<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">In order to support the variability in the size of the Code of the Information Element, we use an LTV (Length-Tag-Value) approach instead of TLVs (Tag-Length-Value).<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">We have considered two approaches for the structure of the EIP Information Elements or EIP LTVs.<a href="#section-4-4" class="pilcrow">¶</a></p>
<div id="proposed-approach-1-for-eip-ltvs">
<section id="section-4.1">
        <h3 id="name-proposed-approach-1-for-eip">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-proposed-approach-1-for-eip" class="section-name selfRef">Proposed approach #1 for EIP LTVs.</a>
        </h3>
<p id="section-4.1-1">In this approach, we have one byte LTV Data Length field. The LTV Data Len is in octets (up to 255 bytes for the LTV Data Length).<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |LTV Data Len=xx|0| EIP-LTV Code|       LTV content             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          LTV content (optional, variable lenght)              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |LTV Data Len=xx|1|  EIP extended LTV Code      | LTV content   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          LTV content (optional, variable lenght)              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3">In this approach, we can have 128 codes of one byte and 32768 codes of 2 bytes.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="proposed-approach-2-for-eip-ltvs">
<section id="section-4.2">
        <h3 id="name-proposed-approach-2-for-eip">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-proposed-approach-2-for-eip" class="section-name selfRef">Proposed approach #2 for EIP LTVs.</a>
        </h3>
<p id="section-4.2-1">In this second approach, the first two bits of the Len field can differentiate the code length,
and the remaining 6 bits will specify the length of the optional part of the LTV content in 32 bits units (4-octets units). The LTV Data length can be up to 63x4=252 bytes (covering the optional part).<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Note that when the Data Len is 0, the optional part of the LTV content is not present, and the Information Element is made only of 4 bytes (i.e. one row in the figures below).<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-3">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |0 1| Data Len  | EIP-LTV Code  |        LTV content            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          LTV content (optional, variable lenght)              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |1 0| Data Len  |    EIP extended LTV Code      | LTV content   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          LTV content (optional, variable lenght)              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |1 1| Data Len  |       EIP double-extended LTV Code            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          LTV content (optional, variable lenght)              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2-3" class="pilcrow">¶</a>
</div>
<p id="section-4.2-4">In this approach, we can have 256 codes of one byte, 65536 codes of 2 bytes
and 2^24 codes of 3 bytes. The codes of one byte will be referred to as "Short codes", the codes of two bytes will be referred to as "Extended codes", the codes of three bytes will be referred to as "Double extended codes".<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="decision-on-the-approach-for-eip-ltvs">
<section id="section-4.3">
        <h3 id="name-decision-on-the-approach-fo">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-decision-on-the-approach-fo" class="section-name selfRef">Decision on the approach for EIP LTVs</a>
        </h3>
<p id="section-4.3-1">The selected approach is the #2, because it is more flexible and it supports a much higher number of Information Elements Codes.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="definition-of-eip-information-elements-aka-eip-ltvs">
<section id="section-5">
      <h2 id="name-definition-of-eip-informati">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-definition-of-eip-informati" class="section-name selfRef">Definition of EIP Information Elements (a.k.a. EIP LTVs)</a>
      </h2>
<div id="hmac-ltv">
<section id="section-5.1">
        <h3 id="name-hmac-ltv">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-hmac-ltv" class="section-name selfRef">HMAC LTV</a>
        </h3>
<p id="section-5.1-1">Alignment requirement: 8n (TODO: maybe it will be 4n)<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The keyed Hashed Message Authentication Code (HMAC) LTV is <span class="bcp14">OPTIONAL</span>
and has the following format:<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-3">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |1 0|  Data Len |    EIP extended LTV code      |  RESERVED     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      HMAC Key ID (4 octets)                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                              //
   |                      HMAC (variable)                         //
   |                                                              //
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1-4">EIP extended LTV code:  HMAC (see <a href="#ltv-ext-codes" class="auto internal xref">Table 3</a> in <a href="#sec-ext-ltv-codes" class="auto internal xref">Section 6.2</a>)<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">Data Len:  the length of HMAC LTV in 4-bytes units, excluding the first row:
the counting starts from the second row (HMAC Key ID).<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">RESERVED:  8 bits.  <span class="bcp14">MUST</span> be 0 on transmission.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1-7">HMAC Key ID:  A 4-octet opaque number that uniquely identifies the
pre-shared key and algorithm used to generate the HMAC.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<p id="section-5.1-8">HMAC:  Keyed HMAC, in multiples of 8 octets, at most 32 octets.<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<p id="section-5.1-9">The details of the use of the HMAC LTV (HMAC Generation and Verification and
HMAC Algorithms) are borrowed from section 2.1.2 of RFC 8754 <span>[<a href="#RFC8754" class="cite xref">RFC8754</a>]</span>.<a href="#section-5.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="eip-identifiers-ltvs">
<section id="section-5.2">
        <h3 id="name-eip-identifiers-ltvs">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-eip-identifiers-ltvs" class="section-name selfRef">EIP Identifiers LTVs</a>
        </h3>
<p id="section-5.2-1">EIP identifiers can be used for different use-cases. For example, they can be used to
identify a "slice", or a Customer, or they can be used to carry a "Contract Identifier".
Two classes of EIP Identifies are defined, Short and Long Identifiers. Short Identifiers
are 16 bits Identifiers. Long Identifiers are Nx32 bits long (N&gt;=1).
Long Identifiers can be further structured according to the specific use case.
EIP Long Identifiers can also be used to carry sequence numbers or transaction identifiers
to identify a specific packet or a specific transaction.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="eip-short-identifier-ltv">
<section id="section-5.2.1">
          <h4 id="name-eip-short-identifier-ltv">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-eip-short-identifier-ltv" class="section-name selfRef">EIP Short Identifier LTV</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.2.1-1">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |0 1| Data Len  | EIP-LTV code  |    Short  Identifier          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.2.1-1" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1-2">EIP-LTV code: Short Identifier (see <a href="#ltv-codes" class="auto internal xref">Table 2</a> in <a href="#sec-ltv-codes" class="auto internal xref">Section 6.1</a>)<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1-3">Data Len:  The length of the variable-length data in 4-bytes units is
zero in this case.<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1-4">Short Identifier: it is a 16 bits identifier, useful when up to 65536
different Identifiers are needed.<a href="#section-5.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="eip-long-identifier-ltv">
<section id="section-5.2.2">
          <h4 id="name-eip-long-identifier-ltv">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-eip-long-identifier-ltv" class="section-name selfRef">EIP Long Identifier LTV</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.2.2-1">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |1 0| Data Len  |     EIP extended LTV code     |    ID type    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |              EIP Long Identifier   (variable lenght)          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.2.2-1" class="pilcrow">¶</a>
</div>
<p id="section-5.2.2-2">EIP extended LTV code: Long Identifier (see <a href="#ltv-ext-codes" class="auto internal xref">Table 3</a> in <a href="#sec-ext-ltv-codes" class="auto internal xref">Section 6.2</a>)<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2.2-3">Data Len:  The length of the variable-length part of the data in 4-bytes units.<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2.2-4">ID type: maybe used to qualify different types of identifiers. By default it is zero.
An ID type can be used to specify a structure for the variable length part of
the Long Identifier.<a href="#section-5.2.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2.2-5">EIP Long Identifier: an identifier of variable length (in multiple of 4 bytes)<a href="#section-5.2.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.2-6">
<pre>
ID type = 0 : Generic Long Identifier
ID type = 1 : Sequence Number only
ID type = 2 : Sequence Number and Generic Long Identifier
</pre><a href="#section-5.2.2-6" class="pilcrow">¶</a>
</div>
<p id="section-5.2.2-7">The EIP Long Identifier LTV only carrying a Sequence Number is shown hereafter.<a href="#section-5.2.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.2-8">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |1 0| DataLen=1 |  EIP_ext_cod=Long Identifier  |  ID type = 1  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Sequence number                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.2.2-8" class="pilcrow">¶</a>
</div>
<p id="section-5.2.2-9">The EIP Long Identifier LTV carrying a Sequence Number in addition to a generic Long
identifier is shown hereafter.<a href="#section-5.2.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.2-10">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |1 0| DataLen&gt;1 |  EIP_ext_cod=Long Identifier  |  ID type = 2  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Sequence number                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |              EIP Long Identifier   (variable lenght)          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.2.2-10" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="timestamps-ltv">
<section id="section-5.3">
        <h3 id="name-timestamps-ltv">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-timestamps-ltv" class="section-name selfRef">Timestamps LTV:</a>
        </h3>
<p id="section-5.3-1">The Timestamp Information Element can used to collect timing information in different
nodes along the packet path (source, destination, intermediate nodes), according to
different use cases.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-2">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |0 1| Data Len  | EIP-LTV code  |  Timestamps TLV Parameters    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           Timestamps TLV content (variable lenght)            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3-3">EIP-LTV code: Timestamps (see <a href="#ltv-codes" class="auto internal xref">Table 2</a> in <a href="#sec-ltv-codes" class="auto internal xref">Section 6.1</a>)<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">The "Timestamps TLV Parameters" is a 16 bits field, it is split into two 8 bits
fields as follows:<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-5">
<pre>
    0                   1
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    Type       | Parameters    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.3-5" class="pilcrow">¶</a>
</div>
<p id="section-5.3-6">Type : it further characterizes the format and the content of Timestamps<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<p id="section-5.3-7">Timestamp Type: Basic = 1<a href="#section-5.3-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-8">
<pre>
    0                   1
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    Type=1     |LEN|Format |RES|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.3-8" class="pilcrow">¶</a>
</div>
<p id="section-5.3-9">LEN: the lenght of each timestamp<a href="#section-5.3-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-10">
<pre>
00 : 1 byte
01 : 2 bytes
10 : 4 bytes
11 : 8 bytes
</pre><a href="#section-5.3-10" class="pilcrow">¶</a>
</div>
<p id="section-5.3-11">Format: indicates the format of the timestamp<a href="#section-5.3-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-12">
<pre>
0001 :   1 ns
0010 :  10 ns
0011 : 100 ns
0100 :   1 us
0101 :  10 us
0110 : 100 us
0111 :   1 ms
1000 : NTP (only for 8 bytes)
1001 : Linux epoch (only for 8 bytes)
</pre><a href="#section-5.3-12" class="pilcrow">¶</a>
</div>
<p id="section-5.3-13">RES: Reserved, set to 0 0<a href="#section-5.3-13" class="pilcrow">¶</a></p>
<p id="section-5.3-14">Example of a Timestamp TLV of type basic, that carries 8 timestamps
of length 2 bytes, each one representing a time granularity of 10 us.<a href="#section-5.3-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-15">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                   |0|0|1|   EIP   |Opt Data Len=20|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |0 1| Len=4     |  Timestamps   |    Type=1     |0 1|0 1 0 1|0 0|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |               1               |               2               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |               3               |               4               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |               5               |               6               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |               7               |               8               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.3-15" class="pilcrow">¶</a>
</div>
<p id="section-5.3-16">NB using this granularity (10 us) and timestamp size (2 bytes), assuming that
all node clocks are synchronized with a maximum error E [ms] it is possible to
correctly evaluate hop-by-hop delays up to (655-E) [ms]<a href="#section-5.3-16" class="pilcrow">¶</a></p>
<p id="section-5.3-17">The entire timestamp will be reconstructed at last node using system
time and subtracting intermediate timestamps.<a href="#section-5.3-17" class="pilcrow">¶</a></p>
</section>
</div>
<div id="node-selection-and-identification-ltv">
<section id="section-5.4">
        <h3 id="name-node-selection-and-identifi">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-node-selection-and-identifi" class="section-name selfRef">Node selection and identification LTV</a>
        </h3>
<p id="section-5.4-1">This Information Element can be used for two purposes:<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">1) associate some instruction contained in the EIP header to one or more
target nodes in the "downstream" path of the packet<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">example 1.1: ask a specific node to write some information in the EIP header, if this specific
node will be crossed by the packet<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<p id="section-5.4-4">example 1.2: ask one node every N hops to write some information in the EIP header<a href="#section-5.4-4" class="pilcrow">¶</a></p>
<p id="section-5.4-5">2) identify the nodes that have inserted some information in the EIP header<a href="#section-5.4-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4-6">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |0 1| Data Len  | EIP-LTV code  |    Type       |     Scope     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Hop Count   |    Param_1    |    Param_2    |F| Back counter|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        Target node list (optional, variable lenght)           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Collected information list (optional, variable lenght)    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.4-6" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-5.4-7">
<pre>
Type = All nodes (Skip M), Param_1 : M, Param_2 : limit (num. of nodes)
Type = Modulus, Param_1 : modulus, Param_2 : limit
Type = Destination only
Type = Segment End only, Param_2 is the limit
Type = Segment End Modulus, Param_1 : modulus, Param_2 : limit
Type = Target Node(s), Param_2 is the number of nodes
</pre><a href="#section-5.4-7" class="pilcrow">¶</a>
</div>
<p id="section-5.4-8">Scope : If Scope = 0x00 the node selection applies to all the following EIP Information Elements (LTVs)
If Scope = N &gt; 0x00 only to the first N LTVs following the Scope are affected by the selection.<a href="#section-5.4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-accelerator-ltv">
<section id="section-5.5">
        <h3 id="name-processing-accelerator-ltv">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-processing-accelerator-ltv" class="section-name selfRef">Processing Accelerator LTV</a>
        </h3>
<p id="section-5.5-1">The purpose of this LTV is to identify a portion of the EIP Header that has a fixed pre-known format so that it can be processed in a more efficient way, rather than proceeding with a "sequential" parsing.
This is can be used for parallel hardware processing, but also software processing can be optimized.
For example, a pre-known sequence of LTVs following the Processing Accelerator LTV can be processed in parallel. The Processing Accelerator LTV can be used to know in advance the size and type of some fields of the following LTVs in order to speed up the processing.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.5-2">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |0 1|  Len = 0  | Proc. Accel.  | Processing Acceleration ID    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.5-2" class="pilcrow">¶</a>
</div>
<p id="section-5.5-3">Proc. Accel. : EIP Short code (see <a href="#ltv-codes" class="auto internal xref">Table 2</a> in <a href="#sec-ltv-codes" class="auto internal xref">Section 6.1</a>)<a href="#section-5.5-3" class="pilcrow">¶</a></p>
<p id="section-5.5-4">The Processing Acceleration ID is an opaque identifier, its definition is domain-specific.<a href="#section-5.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compact-path-tracing-cpt-ltv">
<section id="section-5.6">
        <h3 id="name-compact-path-tracing-cpt-lt">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-compact-path-tracing-cpt-lt" class="section-name selfRef">Compact Path Tracing (CPT) LTV</a>
        </h3>
<p id="section-5.6-1">This LTV is a porting of the Internet Draft "draft-filsfils-spring-path-tracing" <span>[<a href="#ID-PATH-TRACING" class="cite xref">ID-PATH-TRACING</a>]</span> into the EIP framework. It contains a stack of "MCD" (Midpoint Compressed Data) representing information inserted by every transit router for path tracing purposes.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.6-2">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |1 0|  Length   |         Compact PT            |Type |A|HML|RES|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                          MCD  Stack                           ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.6-2" class="pilcrow">¶</a>
</div>
<p id="section-5.6-3">Compact PT: EIP extended code (see <a href="#ltv-ext-codes" class="auto internal xref">Table 3</a> in <a href="#sec-ext-ltv-codes" class="auto internal xref">Section 6.2</a>)<a href="#section-5.6-3" class="pilcrow">¶</a></p>
<p id="section-5.6-4">Type: 3 bits, specifies the content of the CPT LTV including the format of the MCD element.<a href="#section-5.6-4" class="pilcrow">¶</a></p>
<p id="section-5.6-5">A: Authenticated, set to 1 in Authenticated Mode, 0 otherwise.<a href="#section-5.6-5" class="pilcrow">¶</a></p>
<p id="section-5.6-6">HML: HMAC Length, set to 00 in unauthenticated mode. In authenticated mode, it stores the length of the HMAC field in 8 octects.\
<code>MAC length = (HML + 1) * 8 bytes</code>.\
Max length of the HMAC will be 32 octects.<a href="#section-5.6-6" class="pilcrow">¶</a></p>
<p id="section-5.6-7">RES: Reserved, set to 00.<a href="#section-5.6-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.6-8">
<pre>
Ultra Compact (Type = 000)
MCD 24 Bits (3 bytes)
Timestamp (8 bit) | Interface ID (12 bit) | Load (4 bit)
</pre><a href="#section-5.6-8" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-5.6-9">
<pre>
Compact (Type = 001)
MCD 32 Bits (4 bytes)
Timestamp (10 bit) | Interface ID (16 bit) | Load (4 bit) | Timeshift (2 bit)
</pre><a href="#section-5.6-9" class="pilcrow">¶</a>
</div>
<p id="section-5.6-10">The MCD Stack has variable size. <span>[<a href="#ID-PATH-TRACING" class="cite xref">ID-PATH-TRACING</a>]</span> recommends 36 octets for a MCD of 3 bytes (12 MCDs).<a href="#section-5.6-10" class="pilcrow">¶</a></p>
<p id="section-5.6-11">In our case, taking into account the alignment requirements, we have the following recommendation.<a href="#section-5.6-11" class="pilcrow">¶</a></p>
<p id="section-5.6-12">When MCD is 3 bytes, we recommend 13 MCDs for a total of 39 bytes.
When MCD is 4 bytes, we recommend an even number of MCD, for example 10 for a total of 40 bytes or 12 for a total of 48 bytes.<a href="#section-5.6-12" class="pilcrow">¶</a></p>
<div id="authenticated-mode-for-compact-path-tracing">
<section id="section-5.6.1">
          <h4 id="name-authenticated-mode-for-comp">
<a href="#section-5.6.1" class="section-number selfRef">5.6.1. </a><a href="#name-authenticated-mode-for-comp" class="section-name selfRef">Authenticated mode for Compact Path Tracing</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.6.1-1">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |1 0| Data Len  |         Compact PT            |Type |A|HML|RES|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                          MCD  Stack                           ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                             HMAC                              ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.6.1-1" class="pilcrow">¶</a>
</div>
<p id="section-5.6.1-2">In the authenticated mode, an HMAC is appended at the end of the MCD Stack. The size of the HMAC is a multiple of 8 octects (maximum 32 octects).<a href="#section-5.6.1-2" class="pilcrow">¶</a></p>
<p id="section-5.6.1-3">Each intermediate node calculates the HMAC for the whole CPT LTV, including the HMAC field. The newly calculated HMAC then overwrites the previous node's HMAC. The first node will just use an HMAC field set to all zeros.
An identifier for every single node is not needed, because it can be derived from the MCD Stack.
The destination node can reconstruct the different HMAC fields at heach hop to check if the final HMAC is consistent.<a href="#section-5.6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="geotagged-compact-path-tracing">
<section id="section-5.6.2">
          <h4 id="name-geotagged-compact-path-trac">
<a href="#section-5.6.2" class="section-number selfRef">5.6.2. </a><a href="#name-geotagged-compact-path-trac" class="section-name selfRef">Geotagged Compact Path Tracing</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.6.2-1">
<pre>
TODO
</pre><a href="#section-5.6.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="geotagging-ltv">
<section id="section-5.7">
        <h3 id="name-geotagging-ltv">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-geotagging-ltv" class="section-name selfRef">Geotagging LTV</a>
        </h3>
<p id="section-5.7-1">We describe an LTV for Semantic Routing use case.<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.7-2">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |1 0|  Length   |        Geotagging             |S|D|Form.| RES |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Position(s) (Variable)                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.7-2" class="pilcrow">¶</a>
</div>
<p id="section-5.7-3">Geotagging for Semantic Routing: EIP extended code (see <a href="#ltv-ext-codes" class="auto internal xref">Table 3</a> in <a href="#sec-ext-ltv-codes" class="auto internal xref">Section 6.2</a>)<a href="#section-5.7-3" class="pilcrow">¶</a></p>
<p id="section-5.7-4">S: (for Source) the Position includes the Source Location<a href="#section-5.7-4" class="pilcrow">¶</a></p>
<p id="section-5.7-5">D: (for Destination) the Position includes the Destination Location<a href="#section-5.7-5" class="pilcrow">¶</a></p>
<p id="section-5.7-6">Format: 3 bits, specifies the encoding used to represent the geographical location(s).<a href="#section-5.7-6" class="pilcrow">¶</a></p>
<p id="section-5.7-7">RES: Reserved, set to 0.<a href="#section-5.7-7" class="pilcrow">¶</a></p>
<p id="section-5.7-8">Position(s): Contains the geographical location data. Its length must be a multiple of 4 octects.<a href="#section-5.7-8" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Format</th>
              <th class="text-left" rowspan="1" colspan="1">Encoding</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Quantized Long: Latitude 32 bits, Longitude 32 bits</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Quantized Short: Latitude 16 bits, Longitude 16 bits</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">Geohash Long 60 bits (padded to 64 bits)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">Geohash Short 30 bits (padded to 32 bits)</td>
            </tr>
          </tbody>
        </table>
<p id="section-5.7-10">Quantized format as described in https://mmcloughlin.com/posts/geohash-assembly. Latitude and longitude are quantized by mapping to the unit interval [0, 1] and multiplying by 2^32 for Long format (32+32=64 bits) and by 2^16 for Short format (16+16=32 bits), as illustrated in the following formulas:<a href="#section-5.7-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.7-11">
<pre>
lat_long = floor( 2^32 * (lat + 90) / 180 )
lon_long = floor( 2^32 * (lon + 180) / 360 )

lat_short = floor( 2^16 * (lat + 90) / 180 )
lon_short = floor( 2^16 * (lon + 180) / 360 )
</pre><a href="#section-5.7-11" class="pilcrow">¶</a>
</div>
<p id="section-5.7-12">Geohash format is an open source format specified in https://en.wikipedia.org/wiki/Geohash<a href="#section-5.7-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.7-13">
<pre>
Quantized Long (Format = 0)
64 bits (32 lat + 32 lon)
LAT error: ± 2.3 mm
LONG max error: ± 4.6 mm
</pre><a href="#section-5.7-13" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-5.7-14">
<pre>
Quantized Short (Format = 1)
32 bits (16 lat + 16 lon)
LAT error: ± 153 m
LONG max error: ± 305 m
</pre><a href="#section-5.7-14" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-5.7-15">
<pre>
Geohash Long (Format = 2)
60 bits + 4 bits padding
LAT error: ± 18.6 mm
LONG max error: ± 9.3 mm
</pre><a href="#section-5.7-15" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-5.7-16">
<pre>
Geohash Short (Format = 3)
30 bits + 2 bits padding
LAT error: ± 610 m
LONG max error: ± 305 m
</pre><a href="#section-5.7-16" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="simple-two-way-active-measurement-protocol-stamp-ltv">
<section id="section-5.8">
        <h3 id="name-simple-two-way-active-measu">
<a href="#section-5.8" class="section-number selfRef">5.8. </a><a href="#name-simple-two-way-active-measu" class="section-name selfRef">Simple Two-Way Active Measurement Protocol (STAMP) LTV</a>
        </h3>
<p id="section-5.8-1">This is a porting to EIP of the STAMP implementation from <a href="https://www.rfc-editor.org/rfc/rfc8972.html">RFC8972</a>.<a href="#section-5.8-1" class="pilcrow">¶</a></p>
<p id="section-5.8-2">The original implementation writes the STAMP data in the UDP payload, if the data is carried by EIP instead, the delay measurement can be performed in-band. This is true when the delay introduced by the reflector is not relevant for the purpose of the measurement. Indeed, the reflected STAMP data will be returned to the sender when another packet is available for piggy-backing the STAMP data.<a href="#section-5.8-2" class="pilcrow">¶</a></p>
<p id="section-5.8-3">When the entire rount-trip delay is relevant, at least the reflected packet should be sent out-of-band to achieve the smallest possible delay when the Reflector processes the packet.<a href="#section-5.8-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.8-4">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |1 0|  Length   |             STAMP             |D|A|    RES    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                   STAMP content (variable)                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.8-4" class="pilcrow">¶</a>
</div>
<p id="section-5.8-5">D: Direction, set to 0 if it carries Sender data, 1 for Reflector data.<a href="#section-5.8-5" class="pilcrow">¶</a></p>
<p id="section-5.8-6">A: Authenticated, set to 1 for Authenticated Mode.<a href="#section-5.8-6" class="pilcrow">¶</a></p>
<p id="section-5.8-7">RES: Reserved, 6 bits set to 0.<a href="#section-5.8-7" class="pilcrow">¶</a></p>
<p id="section-5.8-8">The STAMP content is variable. It changes depending on the Direction and Authenticated values.<a href="#section-5.8-8" class="pilcrow">¶</a></p>
<p id="section-5.8-9">Following is an example of a Session-Sender STAMP Information Element in Unauthenticated Mode:<a href="#section-5.8-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.8-10">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |1 0|  Length   |             STAMP             |D|A|    RES    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Sequence Number                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Timestamp                            |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         Error Estimate        |             SSID              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                                                               |
   |                         MBZ (28 octets)                       |
   |                                                               |
   |                                                               |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                            TLVs                               ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.8-10" class="pilcrow">¶</a>
</div>
<p id="section-5.8-11">The detailed description of the remaining fields and of the other formats, for the Reflector and Authenticated mode, can be found in RFC8972.<a href="#section-5.8-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="code-assignment-for-eip-information-elements-aka-eip-ltvs">
<section id="section-6">
      <h2 id="name-code-assignment-for-eip-inf">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-code-assignment-for-eip-inf" class="section-name selfRef">Code assignment for EIP Information Elements (a.k.a. EIP LTVs)</a>
      </h2>
<div id="sec-ltv-codes">
<section id="section-6.1">
        <h3 id="name-ltv-short-codes">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-ltv-short-codes" class="section-name selfRef">LTV Short Codes</a>
        </h3>
<span id="name-short-codes-1-bytes-for-eip"></span><div id="ltv-codes">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-short-codes-1-bytes-for-eip" class="selfRef">Short Codes (1 bytes) for EIP LTVs</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Information Element</th>
              <th class="text-left" rowspan="1" colspan="1">Code</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Short Identifier</td>
              <td class="text-left" rowspan="1" colspan="1">0x01</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Processing Accelerator</td>
              <td class="text-left" rowspan="1" colspan="1">0x02</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Timestamps</td>
              <td class="text-left" rowspan="1" colspan="1">TBA</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-ext-ltv-codes">
<section id="section-6.2">
        <h3 id="name-ltv-extended-codes">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-ltv-extended-codes" class="section-name selfRef">LTV Extended Codes</a>
        </h3>
<span id="name-extended-codes-2-bytes-for-"></span><div id="ltv-ext-codes">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-extended-codes-2-bytes-for-" class="selfRef">Extended Codes (2 bytes) for EIP LTVs</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Information Element</th>
              <th class="text-left" rowspan="1" colspan="1">Code</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">HMAC</td>
              <td class="text-left" rowspan="1" colspan="1">0x0001</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Compact Path Tracing (CPT)</td>
              <td class="text-left" rowspan="1" colspan="1">0x0002</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Long Identifier</td>
              <td class="text-left" rowspan="1" colspan="1">0x0003</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Geotagging</td>
              <td class="text-left" rowspan="1" colspan="1">0x0004</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-7">
      <h2 id="name-conventions-and-definitions">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-7-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">TODO Security<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document has no IANA actions.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8754">[RFC8754]</dt>
      <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Dukes, D., Ed.</span>, <span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Leddy, J.</span>, <span class="refAuthor">Matsushima, S.</span>, and <span class="refAuthor">D. Voyer</span>, <span class="refTitle">"IPv6 Segment Routing Header (SRH)"</span>, <span class="seriesInfo">RFC 8754</span>, <span class="seriesInfo">DOI 10.17487/RFC8754</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8754">https://www.rfc-editor.org/rfc/rfc8754</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="id-eip-arch">[id-eip-arch]</dt>
        <dd>
<span class="refAuthor">Salsano, S.</span> and <span class="refAuthor">H. ElBakoury</span>, <span class="refTitle">"Extensible In-band Processing (EIP) Architecture and Framework"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://eip-home.github.io/eip-arch/draft-eip-arch.txt">https://eip-home.github.io/eip-arch/draft-eip-arch.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="id-eip-use-cases">[id-eip-use-cases]</dt>
        <dd>
<span class="refAuthor">Salsano, S.</span> and <span class="refAuthor">H. ElBakoury</span>, <span class="refTitle">"Extensible In-band Processing (EIP) Use Cases"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://eip-home.github.io/eip-headers/draft-eip-use-cases.txt">https://eip-home.github.io/eip-headers/draft-eip-use-cases.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ID-PATH-TRACING">[ID-PATH-TRACING]</dt>
      <dd>
<span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Abdelsalam, A.</span>, <span class="refAuthor">Camarillo, P.</span>, <span class="refAuthor">Yufit, M.</span>, <span class="refAuthor">Graf, T.</span>, <span class="refAuthor">Su, Y.</span>, <span class="refAuthor">Matsushima, S.</span>, <span class="refAuthor">Valentine, M.</span>, and <span class="refAuthor">Dhamija</span>, <span class="refTitle">"Path Tracing in SRv6 networks"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-filsfils-spring-path-tracing-05</span>, <time datetime="2023-10-23" class="refDate">23 October 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-filsfils-spring-path-tracing-05">https://datatracker.ietf.org/doc/html/draft-filsfils-spring-path-tracing-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">Giulio Sidoretti has contributed to the section on Compact Path Tracing.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Stefano Salsano</span></div>
<div dir="auto" class="left"><span class="org">Univ. of Rome Tor Vergata / CNIT</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:stefano.salsano@uniroma2.it" class="email">stefano.salsano@uniroma2.it</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hesham ElBakoury</span></div>
<div dir="auto" class="left"><span class="org">Consultant</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:helbakoury@gmail.com" class="email">helbakoury@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Giulio Sidoretti</span></div>
<div dir="auto" class="left"><span class="org">Univ. of Rome Tor Vergata / CNIT</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:giulio.sidoretti@uniroma2.it" class="email">giulio.sidoretti@uniroma2.it</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Carmine Scarpitta</span></div>
<div dir="auto" class="left"><span class="org">Univ. of Rome Tor Vergata / CNIT</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:carmine.scarpitta@uniroma2.it" class="email">carmine.scarpitta@uniroma2.it</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
